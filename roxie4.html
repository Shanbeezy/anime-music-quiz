<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify API Music Example</title>
</head>
<body>
    <h1>Spotify API Example</h1>
    <input type="text" id="searchInput" placeholder="Search for a track...">
    <button onclick="search()">Search</button>
    <div id="results"></div>

    <script>
        const clientID = '';
        const clientSecret = '';

        // Base64 encode clientID:clientSecret
        const basicToken = btoa(`${clientID}:${clientSecret}`);

        let accessToken = '';

        async function getToken() {
            const response = await fetch('https://accounts.spotify.com/api/token', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'Authorization': `Basic ${basicToken}`
                },
                body: 'grant_type=client_credentials'
            });

            const data = await response.json();
            accessToken = data.access_token;
        }

        async function search() {
            if (!accessToken) {
                await getToken();
            }

            const searchInput = document.getElementById('searchInput').value.trim();
            if (!searchInput) {
                console.error('Please enter a search query');
                return;
            }

            // Search for tracks by anime-related artists or albums
            const apiUrl = `https://api.spotify.com/v1/search?q=${encodeURIComponent(searchInput)}&type=artist,album`;

            try {
                const response = await fetch(apiUrl, {
                    headers: {
                        'Authorization': `Bearer ${accessToken}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();

                    // Filter the search results to include only anime-related artists or albums
                    const animeTracks = filterAnimeTracks(data);
                    displayResults(animeTracks);
                } else {
                    throw new Error('Failed to fetch data');
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        function filterAnimeTracks(data) {
            const animeTracks = [];

            // Example: Check if the artists or albums contain anime-related keywords
            data.artists.items.forEach(artist => {
                if (artist.name.toLowerCase().includes('anime')) {
                    animeTracks.push(artist);
                }
            });

            data.albums.items.forEach(album => {
                if (album.name.toLowerCase().includes('anime')) {
                    animeTracks.push(album);
                }
            });

            return animeTracks;
        }

        function displayResults(tracks) {
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '';

            if (tracks.length === 0) {
                resultsContainer.innerHTML = '<p>No results found</p>';
                return;
            }

            const ul = document.createElement('ul');

            tracks.forEach(track => {
                const li = document.createElement('li');
                const link = document.createElement('a');

                // Adjust link and text based on whether it's an artist or an album
                if (track.type === 'artist') {
                    link.href = track.external_urls.spotify;
                    link.textContent = track.name;
                } else if (track.type === 'album') {
                    link.href = track.external_urls.spotify;
                    link.textContent = track.name;
                }

                li.appendChild(link);
                ul.appendChild(li);
            });

            resultsContainer.appendChild(ul);
        }
    </script>
</body>
</html>
